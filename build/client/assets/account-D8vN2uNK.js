import{_ as W,c as X,e as Z}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as J}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{d as j,O as M,Q as K,P as ee,h as x,b as y,q as o,D as I,w as m,e as E,a as e,c as $,v as a,s as B,R as se,o as r,y as te,j as le,T as oe,N as ae,x as b,t as ie,V as ne}from"./main-CE88ee4Q.js";import{s as re}from"./index-BGiSEDGv.js";import{s as T}from"./index-Drofbpnb.js";import{_ as q}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{_ as ue}from"./VFileUploader.vue_vue_type_script_setup_true_lang-DHTQRJoi.js";import{c as de}from"./country-by-name-Di7sd6fA.js";import{u as me,$ as ce}from"./use-fetch-CNl_4VEC.js";import{I as D}from"./iconify-0_DS-cBL.js";import{_ as pe}from"./VNavbar.vue_vue_type_script_setup_true_lang-GcHfqelS.js";import{u as fe}from"./use-swrv-ttgJgnvy.js";import{o as ve,s as _e}from"./types-CPE1WPKY.js";import"./bundle-mjs-CLJs87Zn.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";const ge={key:0},be={class:"grid gap-4"},xe={class:"flex flex-col gap-2 items-center"},ye={class:"w-24 aspect-square rounded-full bg-slate-100 dark:bg-slate-800 overflow-hidden"},he=["src","alt"],we={class:"my-2 w-full"},ke={class:"grid gap-2"},Ve={class:"grid gap-2"},$e={class:"grid gap-2"},Ee={class:"grid gap-2"},Ce={class:"grid gap-2"},Ue=j({__name:"admin-profile-editor",props:M({user:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:M(["update"],["update:visible"]),setup(p,{emit:P}){const i=K(),h=ee(p,"visible"),C=P,t=x({name:p.user.name,address:p.user.address||"",phoneNumber:p.user.phoneNumber||"",country:p.user.country||"",region:p.user.region||"",image:p.user.image||""}),w=x(t.value.country?{country:t.value.country}:null),S=d=>{t.value.image=d[0].dataUrl||""},{isFetching:k,error:_,execute:u}=me(()=>"/api/admins/me",{immediate:!1}).put(t).json(),g=async()=>{var d;t.value.name&&((d=w.value)!=null&&d.country&&(t.value.country=w.value.country),await u().then(()=>{_.value||(i.user.name=t.value.name,i.user.image=t.value.image||"",h.value=!1,C("update",t.value))}))},V=()=>{t.value={...t.value,image:""},g()};return(d,l)=>{const U=B,f=ue,s=q,c=T,R=re,L=I;return r(),y("div",null,[o(L,{visible:h.value,"onUpdate:visible":l[6]||(l[6]=n=>h.value=n),header:"Edit Details",modal:"",class:"w-full max-w-96"},{default:m(()=>[d.user?(r(),y("div",ge,[e("div",be,[e("div",xe,[e("div",ye,[t.value.image?(r(),y("img",{key:0,src:t.value.image,alt:t.value.name,class:"w-full h-full object-cover"},null,8,he)):E("",!0),o(a(D),{icon:"ic:baseline-account-circle",style:{"font-size":"96px"}})]),d.user.image?(r(),$(U,{key:0,label:"Remove image",onClick:V})):(r(),$(f,{key:1,size:"small",accept:"image/*","max-file-size":a(se),onSelect:S,onCancel:l[0]||(l[0]=n=>t.value.image=""),onUpload:g,loading:a(k)},null,8,["max-file-size","loading"]))]),e("div",we,[a(_)?(r(),$(s,{key:0,error:a(_)},null,8,["error"])):E("",!0)]),e("div",ke,[l[7]||(l[7]=e("label",{for:"name",class:"text-mute text-sm font- medium"},"Name",-1)),o(c,{id:"name",modelValue:t.value.name,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.name=n)},null,8,["modelValue"])]),e("div",Ve,[l[8]||(l[8]=e("label",{for:"phone-number",class:"text-mute text-sm font- medium"},"Phone Number",-1)),o(c,{id:"phone-number",modelValue:t.value.phoneNumber,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.phoneNumber=n)},null,8,["modelValue"])]),e("div",$e,[l[9]||(l[9]=e("label",{for:"name",class:"text-mute text-sm font- medium"},"House Address",-1)),o(c,{id:"address",modelValue:t.value.address,"onUpdate:modelValue":l[3]||(l[3]=n=>t.value.address=n)},null,8,["modelValue"])]),e("div",Ee,[l[10]||(l[10]=e("label",{for:"country",class:"text-mute text-sm font- medium"},"Country",-1)),o(R,{modelValue:w.value,"onUpdate:modelValue":l[4]||(l[4]=n=>w.value=n),options:a(de),editable:"","option-label":"country",fluid:"","show-clear":""},null,8,["modelValue","options"])]),e("div",Ce,[l[11]||(l[11]=e("label",{for:"region",class:"text-mute text-sm font- medium"},"State/Region",-1)),o(c,{id:"name",modelValue:t.value.region,"onUpdate:modelValue":l[5]||(l[5]=n=>t.value.region=n)},null,8,["modelValue"])]),e("div",null,[o(U,{onClick:g,label:"Submit",fluid:"",icon:"pi pi-check",disabled:a(k)||!t.value.name},null,8,["disabled"])])])])):E("",!0)]),_:1},8,["visible"])])}}}),Ne={class:"h-full"},Pe={class:"mt-2 overflow-y-auto md:h-[calc(100dvh-8rem)]"},Se={key:1},Re={key:2,class:"w-full h-full grid gap-2 md:grid-cols-7"},Le={class:"md:col-span-4 grid gap-2"},ze={class:"flex items-center justify-end gap-2"},Me={class:"grid gap-1"},je={key:0,class:"text-red-500"},Ie={class:"mt-2 flex items-center flex-col md:flex-row justify-center md:justify-normal gap-5 flex-wrap"},Be={key:0,class:"bg-white rounded-full w-36 md:w-28 aspect-square overflow-hidden"},Te=["src","alt"],qe={class:"font-semibold text-4xl md:5xl"},De={class:"flex flex-col gap-2 *:flex-shrink-0"},Ae={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Fe={class:"text-right font-semibold"},Oe={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},Ye={class:"text-right font-semibold"},Ge={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},He={class:"text-right font-semibold"},Qe={class:"md:col-span-3 md:row-span-6 flex flex-col gap-2 *:flex-shrink-0"},ms=j({__name:"account",setup(p){const{isLoading:P,data:i,error:h,mutate:C}=fe(()=>"/api/admins/me/account",ce),t=async f=>{await C(()=>{var s;return Promise.resolve({success:!0,message:"User updated successfully.",user:{...(s=i.value)==null?void 0:s.user,...f}})})},w=ne(),S=te(),k=x(S.query["edit-profile"]==="true"),_=x(!1),u=x(""),g=le(()=>{var f;return!!u.value&&u.value===((f=i.value)==null?void 0:f.user.email)}),V=x(""),d=oe("menu"),l=x([{label:"Edit email address",icon:"pi pi-at",command:()=>_.value=!0},{label:"Edit other details",icon:"pi pi-user-edit",command:()=>k.value=!0}]),U=()=>{var c;if(V.value="",!((c=i.value)!=null&&c.user)||!u.value||g.value)return;const s=ve({email:_e({message:"Email is required"}).email({message:"Enter a valid email"})}).safeParse({email:u.value});if(!s.success){V.value=s.error.errors[0].message;return}w.push({name:"email-verification",query:{e:btoa(i.value.user.email),ev:btoa(u.value),i:i.value.user.id}})};return(f,s)=>{const c=pe,R=ae,L=q,n=B,A=X,F=T,O=I,Y=Ue,N=J,G=ie("RouterLink"),H=Z,Q=W;return r(),$(Q,{name:"admin"},{default:m(()=>[e("div",Ne,[o(c),e("div",Pe,[a(P)?(r(),$(R,{key:0})):a(h)?(r(),y("div",Se,[o(L,{error:a(h),"should-retry":"",onRetry:s[0]||(s[0]=v=>a(C)())},null,8,["error"])])):a(i)?(r(),y("div",Re,[e("div",Le,[o(N,{class:"bg-gradient-y text-white"},{header:m(()=>[e("div",ze,[o(n,{onClick:s[1]||(s[1]=v=>{var z;return(z=d.value)==null?void 0:z.toggle(v)}),size:"small",label:"Edit",icon:"pi pi-user-edit",class:"border-white bg-white text-primary-500"}),o(A,{ref_key:"menu",ref:d,model:l.value,popup:!0},null,8,["model"]),o(O,{visible:_.value,"onUpdate:visible":s[3]||(s[3]=v=>_.value=v),header:"Change Email",modal:"",class:"w-80"},{default:m(()=>[e("div",null,[e("div",Me,[s[5]||(s[5]=e("label",{for:"email",class:"text-mute font-medium text-sm"}," Enter your new email address ",-1)),s[6]||(s[6]=e("small",{class:"text-primary-500"},"You will be asked to verify this email address.",-1)),o(F,{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=v=>u.value=v),fluid:""},null,8,["modelValue"]),g.value||V.value?(r(),y("small",je,b(V.value||"Your new email is the same as your current email."),1)):E("",!0)]),o(n,{onClick:U,disabled:!u.value||g.value,label:"Proceed",icon:"pi pi-arrow-right","icon-pos":"right",fluid:"",class:"mt-4"},null,8,["disabled"])])]),_:1},8,["visible"]),o(Y,{visible:k.value,"onUpdate:visible":s[4]||(s[4]=v=>k.value=v),user:a(i).user,onUpdate:t},null,8,["visible","user"])])]),default:m(()=>[e("div",Ie,[a(i).user.image?(r(),y("div",Be,[e("img",{src:a(i).user.image,alt:a(i).user.name,class:"w-full h-full object-cover"},null,8,Te)])):(r(),$(a(D),{key:1,icon:"ic:baseline-account-circle",style:{"font-size":"120px"}})),e("div",null,[e("h1",qe,b(a(i).user.name),1),e("p",null,b(a(i).user.email),1)])])]),_:1}),o(N,{class:"grid gap-2",header:"Profile"},{default:m(()=>[e("div",De,[e("div",Ae,[s[7]||(s[7]=e("div",{class:"flex items-center"},[e("span",{class:"pi pi-phone text-mute p-1 rounded-full",style:{"font-size":"12px"}}),e("p",{class:"text-mute text-sm font-semibold"},"Phone Number")],-1)),e("p",Fe,b(a(i).user.phoneNumber||"----------"),1)]),e("div",Oe,[s[8]||(s[8]=e("div",{class:"flex items-center"},[e("span",{class:"pi pi-map text-mute p-1 rounded-full",style:{"font-size":"12px"}}),e("p",{class:"text-mute text-sm font-semibold"},"Address")],-1)),e("p",Ye,b(a(i).user.address||"----------"),1)]),e("div",Ge,[s[9]||(s[9]=e("div",{class:"flex items-center"},[e("span",{class:"pi pi-map-marker text-mute p-1 rounded-full",style:{"font-size":"12px"}}),e("p",{class:"text-mute text-sm font-semibold"},"Location")],-1)),e("p",He,b(a(i).user.region||"_____")+", "+b(a(i).user.country||"_____"),1)])])]),_:1})]),e("div",Qe,[o(N,{header:"Change Password"},{default:m(()=>[e("div",null,[o(G,{to:{name:"admin-change-password"}},{default:m(()=>[o(n,{fluid:"",label:"Change Password",icon:"pi pi-key"})]),_:1})])]),_:1}),o(N,{header:"Log Out"},{default:m(()=>[o(H,null,{default:m(()=>[o(n,{fluid:"",label:"Log out",outlined:"",icon:"pi pi-sign-out outlined",severity:"danger"})]),_:1})]),_:1})])])):E("",!0)])])]),_:1})}}});export{ms as default};
