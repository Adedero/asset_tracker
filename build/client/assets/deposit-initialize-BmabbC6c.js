import{_ as L,d as P}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as j}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{a as z,s as G}from"./index-D0QGXrOb.js";import{s as F}from"./index-Drofbpnb.js";import{_ as M}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{d as O,Q,am as Y,h as b,m as H,c as g,w as l,a,q as t,v as s,t as J,s as K,D as X,b as Z,e as ee,N as te,x as y,p as d,V as se,o as p}from"./main-CE88ee4Q.js";import{_ as ae}from"./VNavbar.vue_vue_type_script_setup_true_lang-GcHfqelS.js";import{u as oe,$ as le}from"./use-fetch-CNl_4VEC.js";import{u as ne}from"./use-swrv-ttgJgnvy.js";import{I as re}from"./iconify-0_DS-cBL.js";import"./bundle-mjs-CLJs87Zn.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";const ie={class:"h-full"},ue={class:"flex-col-center gap-1"},de={class:"mt-4 flex items-center justify-center"},ce={key:1,class:"flex-center"},me={class:"text-center"},pe={class:"text-2xl font-semibold"},fe={class:"mt-2 grid gap-y-3 gap-x-2 md:grid-cols-2"},_e={class:"grid gap-1 md:col-span-2"},ve={class:"grid gap-1"},be={class:"grid gap-1"},ge={class:"grid gap-1 md:col-span-2"},ye={class:"text-sm font-semibold text-mute"},xe={class:"mt-4 flex items-center gap-2 justify-end"},Be=O({__name:"deposit-initialize",async setup(we){let x,w;const f=se(),n=Q();n.depositRequest||([x,w]=Y(()=>f.push({name:"user-deposit-currencies"})),await x,w());const _=b(!1),k=b(`/api/users/me/transactions/deposit/initialize?amount=${n.depositRequest.amount}&symbol=${n.depositRequest.currencyAbbr}`),{isLoading:I,error:$,data:o,mutate:R}=ne(k.value,le),q=b({}),{isFetching:V,error:D,data:S,execute:T}=oe("/api/users/me/transactions/deposit",{immediate:!1}).post(q).json(),h=async()=>{if(o.value){if(!n.depositRequest.isWireTransfer){n.depositInitData=o.value,await f.push({name:"user-deposit-preview"});return}q.value={userId:n.user.id,transactionType:"DEPOSIT",transactionStatus:"PENDING",amountInUSD:o.value.request.amount,charge:0,actualAmountInUSD:o.value.request.amount,rate:1,currency:"USD",amountInCurrency:o.value.request.amount,isWireTransfer:!0},await T(),!(D.value||!S.value.success)&&(k.value=null,_.value=!0)}};return H(()=>{n.depositRequest=null}),(ke,e)=>{const N=ae,v=K,W=J("RouterLink"),A=X,B=te,C=M,i=z,c=F,m=G,U=j,E=L;return p(),g(E,{name:"user"},{default:l(()=>[a("div",ie,[t(N),t(A,{visible:_.value,"onUpdate:visible":e[0]||(e[0]=u=>_.value=u),modal:"",closable:!1,header:"Wire Transfer",class:"w-80"},{default:l(()=>[a("div",ue,[t(s(re),{icon:"ic:baseline-check-circle",style:{"font-size":"50px"},class:"text-emerald-500"}),e[3]||(e[3]=a("p",{class:"text-center"}," Your deposit request has been submitted and the details of the wire transfer will be sent to your email address shortly ",-1)),t(W,{to:{name:"user-transactions"},class:"mt-2 w-full"},{default:l(()=>[t(v,{label:"Continue",fluid:""})]),_:1})])]),_:1},8,["visible"]),a("div",de,[s(I)?(p(),g(B,{key:0})):s($)?(p(),Z("div",ce,[t(C,{error:s($),"should-retry":"",onRetry:e[1]||(e[1]=u=>s(R)())},null,8,["error"])])):s(o)?(p(),g(U,{key:2,class:"w-full max-w-[28rem] md:!p-6"},{default:l(()=>{var u;return[a("div",me,[a("p",pe,y(s(P).format(s(o).user.walletBalance)),1),e[4]||(e[4]=a("p",null,"Account Balance",-1))]),t(C,{error:s(D)},null,8,["error"]),a("div",fe,[a("div",_e,[e[7]||(e[7]=a("label",{class:"text-sm font-semibold text-mute"},"Deposit Amount in USD",-1)),t(m,{class:"w-full *:dark:bg-slate-800"},{default:l(()=>[t(i,null,{default:l(()=>e[5]||(e[5]=[d("$")])),_:1,__:[5]}),t(c,{value:s(o).request.amount,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"]),t(i,null,{default:l(()=>e[6]||(e[6]=[d(".00")])),_:1,__:[6]})]),_:1})]),a("div",ve,[e[9]||(e[9]=a("label",{class:"text-sm font-semibold text-mute"},"Rate",-1)),t(m,{class:"w-full *:dark:bg-slate-800"},{default:l(()=>{var r;return[t(i,null,{default:l(()=>e[8]||(e[8]=[d("$")])),_:1,__:[8]}),t(c,{value:s(o).request.isWireTransfer?1:(r=s(o).currency)==null?void 0:r.rate,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]}),_:1})]),a("div",be,[e[11]||(e[11]=a("label",{class:"text-sm font-semibold text-mute"},"Charges",-1)),t(m,{class:"w-full *:dark:bg-slate-800"},{default:l(()=>[t(i,null,{default:l(()=>e[10]||(e[10]=[d("$")])),_:1,__:[10]}),t(c,{value:"0",readonly:"",class:"w-full *:dark:bg-slate-800"})]),_:1})]),a("div",ge,[a("label",ye," Amount in "+y(s(o).request.isWireTransfer?"USD":(u=s(o).currency)==null?void 0:u.abbr),1),t(m,{class:"w-full *:dark:bg-slate-800"},{default:l(()=>[t(i,null,{default:l(()=>{var r;return[d(y(s(o).request.isWireTransfer?"$":((r=s(o).currency)==null?void 0:r.symbol)??"$"),1)]}),_:1}),t(c,{value:s(o).result,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})])]),a("div",xe,[t(v,{onClick:e[2]||(e[2]=r=>s(f).back()),label:"Cancel",severity:"secondary",class:"dark:bg-slate-700"}),t(v,{loading:s(V),onClick:h,label:"Proceed"},null,8,["loading"])])]}),_:1})):ee("",!0)])])]),_:1})}}});export{Be as default};
