import{_ as O,d as T,a as K,s as Q}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{d as J,Y as X,Q as Z,h as C,k as ee,c as v,w as r,a as t,q as s,b as w,e as V,v as a,x as p,C as te,p as g,bs as b,s as se,D as ae,N as le,F as oe,f as re,bt as ne,V as ie,o as u}from"./main-CE88ee4Q.js";import{s as de}from"./index-Drofbpnb.js";import{s as ue,a as me}from"./index-D0QGXrOb.js";import{s as ce}from"./index-DHTAa8Us.js";import{_ as pe}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{_ as fe}from"./VNavbar.vue_vue_type_script_setup_true_lang-GcHfqelS.js";import{u as _e,$ as ve}from"./use-fetch-CNl_4VEC.js";import{u as we}from"./use-swrv-ttgJgnvy.js";import"./bundle-mjs-CLJs87Zn.js";import"./iconify-0_DS-cBL.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";const ge={class:"h-full"},be={key:0,class:"flex-col-center gap-1"},he={class:"text-center"},xe={class:"text-2xl font-semibold"},ye={class:"grid gap-1"},ke={class:"text-slate-500"},Ce={class:"font-semibold"},Ve={class:"grid gap-1"},Ae={class:"w-5 rounded-full overlow-hidden"},$e=["src"],Ne={class:"grid gap-1"},Be={class:"grid gap-1"},Fe={class:"mt-2"},Se={class:"mt-2 overflow-y-auto md:h-[calc(100dvh-8rem)]"},Te={key:1,class:"flex-center"},De={key:2,class:"w-full grid gap-2 grid-cols-[repeat(auto-fill,minmax(200px,1fr))]"},Ee={class:"flex flex-col items-center gap-2"},Ie=["src"],We={class:"font-medium"},qe={class:"text-center text-sm"},Me={class:"font-medium"},Re={class:"text-center text-sm"},Le={class:"font-medium"},at=J({__name:"withdrawal-initialize",setup(Ue){const D=ie(),E=X(),A=Z(),h=C(!1),n=C(),o=C({amount:0,walletAddress:"",walletAddressNetwork:""}),I=async()=>{try{o.value.walletAddress=await navigator.clipboard.readText()}catch(i){console.error(i)}},{isLoading:W,data:$,error:N,mutate:q}=we(()=>"/api/users/me/currencies?where=isAvailableForWithdrawal,true",ve),{isFetching:x,data:d,error:B,execute:M}=_e(()=>{var i;return`/api/users/me/transactions/withdrawal/initialize?symbol=${(i=n.value)==null?void 0:i.abbr}`},{immediate:!1}).get().json(),R=async i=>{var e;n.value=i,i.isFetching=x,await M(),h.value=!0,B.value||(e=d.value)!=null&&e.success},L=()=>{var f,c;const e=[{value:!!d.value,message:"Something went wrong. Try again later."},{value:!!o.value.amount,message:"Enter the amount to withdraw"},{value:!!o.value.walletAddress,message:"Enter your wallet address"},{value:!!n.value,message:"Select a currency"},{value:(((f=d.value)==null?void 0:f.user.walletBalance)||0)-o.value.amount>=b,message:"You do not have sufficient funds to complete this withdrawal"}].find(m=>m.value===!1);if(e){E.add({severity:"error",detail:e.message,life:3e3});return}A.withdrawalRequest={...o.value,currency:{id:n.value.id,abbr:n.value.abbr},user:{walletBalance:((c=d.value)==null?void 0:c.user.walletBalance)||0}},D.push({name:"user-withdrawal-validate"})};return ee(()=>{A.withdrawalRequest=null}),(i,e)=>{const f=fe,c=pe,m=me,U=ce,_=ue,z=K,y=de,k=se,G=ae,Y=le,F=Q,P=H,j=O;return u(),v(j,{name:"user"},{default:r(()=>{var S;return[t("div",ge,[s(f),s(G,{visible:h.value,"onUpdate:visible":e[3]||(e[3]=l=>h.value=l),modal:"",header:`${(S=n.value)==null?void 0:S.abbr} Withdrawal`,class:"w-80 md:w-96"},{default:r(()=>[s(c,{error:a(B),class:"my-2"},null,8,["error"]),a(d)&&n.value?(u(),w("div",be,[t("div",he,[t("p",xe,p(a(T).format(a(d).user.walletBalance)),1),e[5]||(e[5]=t("p",null,"Account Balance",-1))]),t("form",{onSubmit:te(L,["prevent"]),class:"grid gap-3 w-full"},[t("div",ye,[e[10]||(e[10]=t("label",{class:"text-mute font-semibold text-sm"},"Amount",-1)),s(_,{class:"w-full *:dark:bg-slate-800"},{default:r(()=>[s(m,null,{default:r(()=>e[6]||(e[6]=[g("$")])),_:1,__:[6]}),s(U,{modelValue:o.value.amount,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.amount=l),max:a(d).user.walletBalance-a(b),placeholder:"00.00",minFractionDigits:0,maxFractionDigits:2,class:"w-full *:dark:bg-slate-800"},null,8,["modelValue","max"])]),_:1}),t("small",ke,[e[7]||(e[7]=g(" A minimum of ")),t("span",Ce,"$"+p(a(b)),1),e[8]||(e[8]=g(" must be left in your account after withdrawal "))]),a(d).user.walletBalance<o.value.amount+a(b)?(u(),v(z,{key:0,size:"small",severity:"error"},{default:r(()=>e[9]||(e[9]=[g(" You do not have sufficient funds to complete this withdrawal ")])),_:1,__:[9]})):V("",!0)]),t("div",Ve,[e[11]||(e[11]=t("label",{class:"text-mute font-semibold text-sm"},"Currency",-1)),s(_,{class:"w-full *:dark:bg-slate-800"},{default:r(()=>[s(m,null,{default:r(()=>[t("div",Ae,[t("img",{src:n.value.image||"",class:"w-full h-full object-cover"},null,8,$e)])]),_:1}),s(y,{value:n.value.name,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Ne,[e[13]||(e[13]=t("label",{class:"text-mute font-semibold text-sm"},"Your Wallet Address",-1)),s(_,{class:"w-full *:dark:bg-slate-800"},{default:r(()=>[s(m,null,{default:r(()=>e[12]||(e[12]=[t("span",{class:"pi pi-wallet"},null,-1)])),_:1,__:[12]}),s(y,{modelValue:o.value.walletAddress,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.walletAddress=l),placeholder:"e.g. 0x742d35Cc6634C0532925a3b44Bc454e4438f443",class:"w-full *:dark:bg-slate-800"},null,8,["modelValue"]),s(m,null,{default:r(()=>[s(k,{onClick:I,severity:"secondary",icon:"pi pi-clipboard"})]),_:1})]),_:1})]),t("div",Be,[e[15]||(e[15]=t("label",{class:"text-mute font-semibold text-sm"},"Network",-1)),s(_,{class:"w-full *:dark:bg-slate-800"},{default:r(()=>[s(m,null,{default:r(()=>e[14]||(e[14]=[t("span",{class:"pi pi-share-alt"},null,-1)])),_:1,__:[14]}),s(y,{modelValue:o.value.walletAddressNetwork,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.walletAddressNetwork=l),placeholder:"e.g. Kraken",class:"w-full *:dark:bg-slate-800"},null,8,["modelValue"])]),_:1})]),t("div",Fe,[s(k,{type:"submit",loading:a(x),disabled:a(x)||!o.value.amount||!o.value.walletAddress,label:"Confirm",fluid:""},null,8,["loading","disabled"])])],32)])):V("",!0)]),_:1},8,["visible","header"]),t("div",Se,[a(W)?(u(),v(Y,{key:0})):a(N)?(u(),w("div",Te,[s(c,{error:a(N),"should-retry":"",onRetry:e[4]||(e[4]=l=>a(q)())},null,8,["error"])])):a($)?(u(),w("div",De,[(u(!0),w(oe,null,re(a($).currencies,l=>(u(),v(P,{key:l.name,header:l.name},{default:r(()=>[t("div",Ee,[t("img",{src:l.image||"",width:"40",class:"rounded-full"},null,8,Ie),t("p",We,p(l.abbr),1)]),s(F),t("div",qe,[e[16]||(e[16]=t("p",{class:"text-center"},"Fixed Charge",-1)),t("p",Me,p(a(T).format(l.withdrawalCharge)),1)]),t("div",Re,[e[17]||(e[17]=t("p",{class:"text-center"},"Average Processing Time",-1)),t("p",Le,p(a(ne)),1)]),s(F),s(k,{onClick:ze=>R(l),loading:l.isFetching,size:"small",label:`Withdraw via ${l.abbr}`,fluid:""},null,8,["onClick","loading","label"])]),_:2},1032,["header"]))),128))])):V("",!0)])])]}),_:1})}}});export{at as default};
