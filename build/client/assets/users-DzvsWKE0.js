import{_ as P}from"./vue-layout.vue_vue_type_script_setup_true_lang-BNFQYZFa.js";import{_ as R}from"./VPaginator.vue_vue_type_script_setup_true_lang-BpSAoCku.js";import{s as j,a as G}from"./index-5MJVKUv_.js";import{_ as q}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-CPslCPqh.js";import{d as F,h as w,j as v,X as Q,c as h,w as n,a,q as t,s as W,b as p,e as g,v as l,N as X,p as b,x as _,o as i}from"./main-DbwiCszp.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-7nJJ2y1E.js";import{_ as J}from"./user-manager.vue_vue_type_script_setup_true_lang-Cq2B-r_v.js";import{s as K}from"./index-C9xlOZnF.js";import{$ as O}from"./use-fetch-CkegAda4.js";import{u as Y}from"./use-swrv-DVUkzGGN.js";import{I as Z}from"./iconify-D-TZBpbX.js";import"./index-TDOKOudS.js";import"./index-DeLv1j-i.js";import"./index-BxwU-vK-.js";import"./index-55yS1M7a.js";import"./index-CVVhXnti.js";import"./bundle-mjs-CLJs87Zn.js";import"./index-C2bRNVQt.js";import"./index-Bj_xpqlO.js";import"./VFileUploader.vue_vue_type_script_setup_true_lang-hIjdf8F3.js";import"./country-by-name-Di7sd6fA.js";import"./login.schema-BTravW_w.js";import"./types-CPE1WPKY.js";import"./v4-C6aID195.js";const ee={class:"flex items-center gap-2 justify-between"},se={class:"flex flex-wrap items-center justify-end gap-1"},te={class:"mt-2"},oe={key:2,class:"w-full md:h-[calc(100dvh-9rem)] overflow-y-auto"},ae={class:"h-full w-full"},ne={class:"w-full overflow-auto md:max-h-[calc(100dvh-15rem)]"},re={key:0,class:"w-8 aspect-square overflow-hidden rounded-full"},le=["src","alt"],ie={key:0,class:"text-blue-500 font-medium text-xs"},ue={key:1,class:"text-red-500 font-medium text-xs"},me={key:0,class:"flex items-center gap-2"},Me=F({__name:"users",setup(ce){const y=w(0),f=Q,k=v(()=>y.value*f),A=w(["All","Users","Admins","Banned"]),m=w("Users"),I=v(()=>{const s=new URLSearchParams;return s.set("take",f.toString()),s.set("skip",k.value.toString()),s.set("sort","name,asc"),m.value&&m.value!=="All"&&(m.value==="Users"&&s.set("where","role,USER"),m.value==="Admins"&&s.set("where","role,ADMIN"),m.value==="Banned"&&s.set("where","isBanned,true")),s.toString()}),{isLoading:$,data:r,error:U,mutate:V}=Y(()=>`/api/admins/me/users?${I.value}`,O),S=v(()=>{var s;return((s=r.value)==null?void 0:s.users.length)||0}),B=v(()=>{var s;return!!((s=r.value)!=null&&s.users)&&r.value.users.length<f}),N=async s=>{if(!r.value)return;const o=[...r.value.users],d=r.value.users.findIndex(c=>c.id===s.id);if(d===-1)o.unshift({...s,accountGroup:null});else{const c={...r.value.users[d],...s};o.splice(d,1,c)}await V(()=>Promise.resolve({success:!0,message:"User updated successfully",users:o}))};return(s,o)=>{const d=K,c=W,L=J,C=H,D=X,E=q,u=j,M=G,T=R,z=P;return i(),h(z,{name:"admin"},{default:n(()=>[a("div",null,[t(C,{class:"py-2 rounded-xl"},{default:n(()=>[a("div",ee,[o[3]||(o[3]=a("div",{class:"flex items-center gap-2 text-lg font-semibold text-primary-500"},[a("h1",null,"Users")],-1)),a("div",se,[a("div",null,[t(d,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),size:"small",options:A.value},null,8,["modelValue","options"])]),t(L,{onDone:N},{default:n(()=>[t(c,{label:"New",icon:"pi pi-plus",size:"small"})]),_:1})])])]),_:1}),a("div",te,[l($)?(i(),h(D,{key:0})):l(U)?(i(),h(E,{key:1,error:l(U),"should-retry":"",onRetry:o[1]||(o[1]=e=>l(V)())},null,8,["error"])):l(r)&&l(r).users?(i(),p("div",oe,[a("div",ae,[a("div",ne,[t(M,{loading:l($),value:l(r).users,size:"small",class:"text-sm"},{default:n(()=>[t(u,{header:"S/N"},{body:n(({index:e})=>[b(_(e+1+k.value)+") ",1)]),_:1}),t(u,null,{body:n(({data:e})=>[e.image?(i(),p("div",re,[a("img",{src:e.image,alt:e.name,class:"w-full h-full object-cover"},null,8,le)])):(i(),h(l(Z),{key:1,icon:"ic:baseline-account-circle",style:{"font-size":"2rem"},class:"text-primary-500"}))]),_:1}),t(u,{field:"name",header:"Name"},{body:n(({data:e})=>[b(_(e.name)+" ",1),e.role==="ADMIN"?(i(),p("sup",ie," admin ")):g("",!0),e.isBanned?(i(),p("sup",ue," banned ")):g("",!0)]),_:1}),t(u,{field:"email",header:"Email"}),t(u,{field:"phoneNumber",header:"Phone"}),t(u,{header:"Location"},{body:n(({data:e})=>[a("p",null,[a("span",null,_(e.region),1),o[4]||(o[4]=a("span",null,", ",-1)),a("span",null,_(e.country),1)])]),_:1}),t(u,{header:"Account Group"},{body:n(({data:e})=>{var x;return[b(_((x=e.accountGroup)==null?void 0:x.name),1)]}),_:1}),t(u,null,{body:n(({data:e})=>[e.role!=="ADMIN"?(i(),p("div",me,[t(c,{onClick:x=>s.$router.push({name:"admin-user-item",params:{user_id:e.id}}),size:"small",icon:"pi pi-user",rounded:""},null,8,["onClick"]),t(L,{user:e,onDone:N},{default:n(()=>[t(c,{size:"small",icon:"pi pi-user-edit",rounded:"",severity:"secondary"})]),_:2},1032,["user"])])):g("",!0)]),_:1})]),_:1},8,["loading","value"])]),t(T,{allLoaded:B.value,length:S.value,rows:l(f),page:y.value,"onUpdate:page":o[2]||(o[2]=e=>y.value=e)},null,8,["allLoaded","length","rows","page"])])])):g("",!0)])])]),_:1})}}});export{Me as default};
