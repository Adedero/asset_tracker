import{d as S,s as j,a as B,b as N,c as L}from"./index-DKG9RM03.js";import{s as M}from"./index-D1ity6C8.js";import{d as E,h as U,j as F,b as w,q as e,w as t,e as R,v as c,p as T,t as q,s as A,a,ah as D,ap as Y,o as v}from"./main-CE88ee4Q.js";import{u as z,a as G}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as H}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{u as I}from"./use-fetch-CNl_4VEC.js";const J={class:"v-card h-full w-full flex items-center justify-center"},K={key:0,class:"my-2 flex-col-center gap-3"},O={class:"flex flex-col"},Q={class:"grid gap-1"},W={class:"flex pt-6 justify-end"},X={class:"flex flex-col"},Z={class:"grid gap-1"},ee={class:"flex pt-6 justify-between"},se={class:"flex flex-col"},oe={class:"grid gap-1"},ae={class:"text-red-500"},le={class:"flex pt-6 justify-between"},pe=E({__name:"v-password-changer",props:{role:{}},emits:["change"],setup(_,{emit:te}){const{logout:g}=z(),s=U({oldPassword:"",newPassword:"",newPasswordConfirm:""}),{isFetching:m,error:p,data:f,execute:b}=I(()=>`/api/${_.role.toLowerCase()}s/me/password/change`,{immediate:!1}).put(s).json(),P=F(()=>f.value?f.value.success:!1),k=async()=>{await b().then(()=>{p.value||setTimeout(()=>{g()},3e3)})};return(ne,o)=>{const d=B,h=j,x=H,C=G,n=A,y=q("RouterLink"),i=M,u=L,V=N,$=S;return v(),w("div",J,[e($,{value:"1",linear:"",class:"shadow-md border dark:border-slate-600 rounded-xl p-3 bg-white dark:bg-slate-900 md:w-96"},{default:t(()=>[e(h,null,{default:t(()=>[e(d,{value:"1"}),e(d,{value:"2"}),e(d,{value:"3"})]),_:1}),e(x,{error:c(p),class:"my-2"},null,8,["error"]),P.value?(v(),w("div",K,[e(C,{severity:"success"},{default:t(()=>o[3]||(o[3]=[T(" Your password has been changed. Please, log in to continue ")])),_:1,__:[3]}),e(y,{to:{name:"login"},class:"w-full"},{default:t(()=>[e(n,{label:"Log in",fluid:"",icon:"pi pi-sign-in","icon-pos":"right"})]),_:1})])):R("",!0),e(V,null,{default:t(()=>[e(u,{value:"1",class:"dark:bg-slate-900"},{default:t(({activateCallback:r})=>[a("div",O,[a("div",Q,[o[4]||(o[4]=a("label",{for:"oldPassword",class:"text-mute font-semibold text-sm"},"Enter your old password",-1)),e(i,{modelValue:s.value.oldPassword,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.oldPassword=l),modelModifiers:{trim:!0},fluid:"","toggle-mask":"",feedback:!1,"input-class":"dark:bg-slate-800"},null,8,["modelValue"])])]),a("div",W,[e(n,{disabled:!s.value.oldPassword,label:"Next",icon:"pi pi-arrow-right",iconPos:"right",onClick:l=>r("2")},null,8,["disabled","onClick"])])]),_:1}),e(u,{value:"2",class:"dark:bg-slate-900"},{default:t(({activateCallback:r})=>[a("div",X,[a("div",Z,[o[5]||(o[5]=a("label",{for:"oldPassword",class:"text-mute font-semibold text-sm"},"Enter your new password",-1)),o[6]||(o[6]=a("small",{class:"text-primary-500"},"Password must have at least 8 characters",-1)),e(i,{modelValue:s.value.newPassword,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.newPassword=l),modelModifiers:{trim:!0},fluid:"","toggle-mask":"",feedback:!1,"input-class":"dark:bg-slate-800"},null,8,["modelValue"])])]),a("div",ee,[e(n,{label:"Back",severity:"secondary",icon:"pi pi-arrow-left",onClick:l=>r("1")},null,8,["onClick"]),e(n,{disabled:!s.value.newPassword||s.value.newPassword.length<8,label:"Next",icon:"pi pi-arrow-right",iconPos:"right",onClick:l=>r("3")},null,8,["disabled","onClick"])])]),_:1}),e(u,{value:"3",class:"dark:bg-slate-900"},{default:t(({activateCallback:r})=>[a("div",se,[a("div",oe,[o[7]||(o[7]=a("label",{for:"oldPassword",class:"text-mute font-semibold text-sm"},"Confirm your new password",-1)),e(i,{modelValue:s.value.newPasswordConfirm,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.newPasswordConfirm=l),modelModifiers:{trim:!0},fluid:"","toggle-mask":"",feedback:!1,"input-class":"dark:bg-slate-800"},null,8,["modelValue"]),D(a("small",ae," Password does not match your new password ",512),[[Y,s.value.newPasswordConfirm&&s.value.newPasswordConfirm!==s.value.newPassword]])])]),a("div",le,[e(n,{label:"Back",severity:"secondary",icon:"pi pi-arrow-left",onClick:l=>r("2")},null,8,["onClick"]),e(n,{loading:c(m),disabled:c(m)||!s.value.oldPassword||s.value.newPassword.length<8||s.value.newPasswordConfirm!==s.value.newPassword,label:"Submit",icon:"pi pi-check","icon-pos":"right",onClick:k},null,8,["loading","disabled"])])]),_:1})]),_:1})]),_:1})])}}});export{pe as _};
