import{_ as q,d as S,s as E,a as F}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{s as Y}from"./index-Drofbpnb.js";import{_ as j}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{s as z}from"./index-Cf5x4JsD.js";import{d as K,y as O,j as W,c as f,w as l,a as s,q as n,Z,v as a,n as H,x as c,b as g,e as p,N as J,$ as Q,p as C,U as X,F as tt,f as st,o as i}from"./main-CE88ee4Q.js";import{_ as et}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{_ as at}from"./VNavbar.vue_vue_type_script_setup_true_lang-GcHfqelS.js";import{$ as ot}from"./use-fetch-CNl_4VEC.js";import{u as nt}from"./use-swrv-ttgJgnvy.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";import"./bundle-mjs-CLJs87Zn.js";import"./iconify-0_DS-cBL.js";const it={class:"h-full"},rt={class:"flex flex-wrap md:flex-nowrap justify-end items-center gap-2"},lt={class:"text-right"},dt={class:"text-right"},ut={class:"text-emerald-500 font-semibold text-lg md:text-2xl leading-5"},mt={class:"mt-2 overflow-y-auto md:h-[calc(100dvh-9rem)]"},ct={key:1,class:"w-full max-w-[28rem]"},ft={key:2},pt={key:0},_t={class:"grid gap-2 items-start md:grid-cols-7 lg:grid-cols-5"},vt={class:"grid gap-2 md:col-span-3 lg:col-span-2"},gt={class:"flex items-center gap-1"},xt={class:"text-right"},Dt={class:"text-2xl font-semibold"},Ct={class:"flex items-center gap-1"},yt={class:"text-right"},ht={class:"text-2xl font-semibold"},bt={class:"flex items-center gap-1"},St={class:"text-right"},Ut={class:"text-2xl font-semibold"},kt={class:"text-right"},At={class:"text-2xl font-semibold"},Bt={class:"text-sm text-slate-500"},Gt={key:0},Pt={class:"font-semibold"},$t={key:1},Nt={class:"font-semibold"},Vt={class:"text-xs font-normal"},wt={class:"md:col-span-4 lg:col-span-3"},It={class:"text-right text-3xl font-semibold"},Lt={class:"mt-2 grid gap-2"},Rt={class:"grid gap-2 md:grid-cols-6"},Tt={class:"md:col-span-3"},Mt={class:"md:col-span-3"},qt={class:"md:col-span-6"},Et={class:"md:col-span-3"},Ft={class:"md:col-span-3"},Yt={class:"md:col-span-3"},jt={class:"md:col-span-3"},zt={key:1},rs=K({__name:"gift-card-validation-report",setup(Kt){const I=O().params.transaction_id.toString(),{isLoading:L,data:o,error:U,mutate:R}=nt(()=>`/api/admins/me/transactions/${I}`,ot);function h(d){var t,r;return(r=(t=o.value)==null?void 0:t.transaction.giftCardData)==null?void 0:r.cards.filter(u=>u.currency===d).length}const T=W(()=>{var d,t,r;return(((d=o.value)==null?void 0:d.transaction.amountInUSD)||0)>=(((r=(t=o.value)==null?void 0:t.transaction.giftCardData)==null?void 0:r.totalInUSD)||0)});function _(d){var t,r;return(r=(t=o.value)==null?void 0:t.transaction.giftCardData)==null?void 0:r.cards.reduce((u,m)=>m.currency===d?u+m.amount:u,0)}function k(){var t,r;if(!((t=o.value)!=null&&t.transaction.giftCardData))return 0;const{transaction:d}=o.value;return(r=d.giftCardData)==null?void 0:r.cards.reduce((u,m)=>{var y,x;return m.currency==="USD"?u+m.amount:m.currency==="CAD"?u+m.amount/(((y=d.giftCardData)==null?void 0:y.rates.CAD)||1):m.currency==="GBP"?u+m.amount/(((x=d.giftCardData)==null?void 0:x.rates.GBP)||1):u},0)}return(d,t)=>{const r=E,u=at,m=J,y=et,x=Q,b=z,D=j,A=F,v=Y,M=q;return i(),f(M,{name:"admin"},{default:l(()=>{var B;return[s("div",it,[n(u,null,Z({_:2},[a(o)?{name:"right",fn:l(()=>{var e;return[s("div",rt,[s("div",lt,[t[1]||(t[1]=s("small",{class:"text-slate-500"},"Deposited",-1)),s("p",{class:H(`font-semibold text-lg md:text-2xl leading-5 ${T.value?"text-emerald-500":"text-red-500"}`)},c(a(S).format(a(o).transaction.amountInUSD)),3)]),n(r,{layout:"vertical"}),s("div",dt,[t[2]||(t[2]=s("small",{class:"text-slate-500"},"Requested",-1)),s("p",ut,c(a(S).format(((e=a(o).transaction.giftCardData)==null?void 0:e.totalInUSD)||k()||0)),1)])])]}),key:"0"}:void 0]),1024),s("div",mt,[a(L)?(i(),f(m,{key:0})):a(U)?(i(),g("div",ct,[n(y,{error:a(U),"should-retry":"",onRetry:t[0]||(t[0]=e=>a(R)())},null,8,["error"])])):a(o)?(i(),g("div",ft,[a(o).transaction.transactionStatus==="SUCCESSFUL"?(i(),g("div",pt,[s("div",_t,[s("div",vt,[_("USD")?(i(),f(D,{key:0},{header:l(()=>[s("div",gt,[t[3]||(t[3]=s("p",{class:"text-slate-500 font-semibold"},"US Gift Cards",-1)),n(x,{severity:"danger",value:h("USD")},null,8,["value"])])]),default:l(()=>{var e;return[s("div",xt,[n(b,{value:"USD"}),s("p",Dt,c(((e=_("USD"))==null?void 0:e.toLocaleString())||0),1)])]}),_:1})):p("",!0),_("CAD")?(i(),f(D,{key:1,header:"Canadian Gift Cards"},{header:l(()=>[s("div",Ct,[t[4]||(t[4]=s("p",{class:"text-slate-500 font-semibold"},"Canadian Gift Cards",-1)),n(x,{severity:"danger",value:h("CAD")},null,8,["value"])])]),default:l(()=>{var e;return[s("div",yt,[n(b,{value:"CAD"}),s("p",ht,c(((e=_("CAD"))==null?void 0:e.toLocaleString())||0),1)])]}),_:1})):p("",!0),_("GBP")?(i(),f(D,{key:2,header:"UK Gift Cards"},{header:l(()=>[s("div",bt,[t[5]||(t[5]=s("p",{class:"text-slate-500 font-semibold"},"UK Gift Cards",-1)),n(x,{severity:"danger",value:h("GBP")},null,8,["value"])])]),default:l(()=>{var e;return[s("div",St,[n(b,{value:"GBP"}),s("p",Ut,c(((e=_("GBP"))==null?void 0:e.toLocaleString())||0),1)])]}),_:1})):p("",!0),n(D,{header:"Requested Total (USD)"},{default:l(()=>{var e,G,P,$,N,V,w;return[s("div",kt,[s("p",At,c(a(S).format(((e=a(o).transaction.giftCardData)==null?void 0:e.totalInUSD)||k()||0)),1)]),(G=a(o).transaction.giftCardData)!=null&&G.rates.CAD||(P=a(o).transaction.giftCardData)!=null&&P.rates.GBP?(i(),f(r,{key:0})):p("",!0),s("div",Bt,[($=a(o).transaction.giftCardData)!=null&&$.rates.CAD?(i(),g("div",Gt,[t[6]||(t[6]=s("span",{class:"font-medium"},"1 USD",-1)),t[7]||(t[7]=C(" = ")),s("span",Pt," CAD "+c(a(o).transaction.giftCardData.rates.CAD),1)])):p("",!0),(N=a(o).transaction.giftCardData)!=null&&N.rates.GBP?(i(),g("div",$t,[t[8]||(t[8]=s("span",{class:"font-medium"},"1 USD",-1)),t[9]||(t[9]=C(" = ")),s("span",Nt," GBP "+c(a(o).transaction.giftCardData.rates.GBP),1)])):p("",!0)]),(V=a(o).transaction.giftCardData)!=null&&V.rates.CAD||(w=a(o).transaction.giftCardData)!=null&&w.rates.GBP?(i(),f(r,{key:1})):p("",!0),_("CAD")||_("GBP")?(i(),f(A,{key:2,size:"small"},{default:l(()=>[s("p",Vt,[t[10]||(t[10]=C(" The rates above were based on the market rates at the time of the creation of the deposit request : ")),s("b",null,c(a(X)(a(o).transaction.createdAt,"MMM DD, YYYY hh:mm:ss aa")),1),t[11]||(t[11]=C(". ")),t[12]||(t[12]=s("br",null,null,-1)),t[13]||(t[13]=C(" Please note that at the time of validating the gift cards, the rates may have changed. "))])]),_:1})):p("",!0)]}),_:1})]),s("div",wt,[n(D,{header:"All Gift Cards"},{default:l(()=>{var e;return[s("p",It,c((e=a(o).transaction.giftCardData)==null?void 0:e.cards.length),1)]}),_:1}),s("div",Lt,[(i(!0),g(tt,null,st(((B=a(o).transaction.giftCardData)==null?void 0:B.cards)||[],e=>(i(),f(D,{class:"border"},{default:l(()=>[s("div",Rt,[s("div",Tt,[t[14]||(t[14]=s("span",{class:"text-sm font-medium text-slate-500"},"Type",-1)),n(v,{value:e.type,fluid:"",disabled:""},null,8,["value"])]),s("div",Mt,[t[15]||(t[15]=s("span",{class:"text-sm font-medium text-slate-500"},"Country",-1)),n(v,{value:e.country,fluid:"",disabled:""},null,8,["value"])]),s("div",qt,[t[16]||(t[16]=s("span",{class:"text-sm font-medium text-slate-500"},"Card Number",-1)),n(v,{value:e.cardNumber,fluid:"",disabled:""},null,8,["value"])]),s("div",Et,[t[17]||(t[17]=s("span",{class:"text-sm font-medium text-slate-500"},"PIN/Security Code",-1)),n(v,{value:e.pin,fluid:"",disabled:""},null,8,["value"])]),s("div",Ft,[t[18]||(t[18]=s("span",{class:"text-sm font-medium text-slate-500"},"Amount/Balance",-1)),n(v,{value:e.amount,fluid:"",disabled:""},null,8,["value"])]),s("div",Yt,[t[19]||(t[19]=s("span",{class:"text-sm font-medium text-slate-500"},"Amount Retrieved",-1)),n(v,{value:e.amountRetrieved,fluid:"",disabled:""},null,8,["value"])]),s("div",jt,[t[20]||(t[20]=s("span",{class:"text-sm font-medium text-slate-500"},"Rate Used",-1)),n(v,{value:e.rateUsed,fluid:"",disabled:""},null,8,["value"])])])]),_:2},1024))),256))])])])])):(i(),g("div",zt,[n(A,null,{default:l(()=>t[21]||(t[21]=[C(" No report exists for this gift card transaction because it has not yet been approved. ")])),_:1,__:[21]})]))])):p("",!0)])])]}),_:1})}}});export{rs as default};
