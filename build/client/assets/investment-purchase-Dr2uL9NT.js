import{O as T,d as K,a as te,s as j,_ as ne}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{s as se}from"./index-CFcbhqS3.js";import{E as oe,G as ie,a2 as re,a3 as ae,a4 as le,J as de,a5 as ue,H as ce,a6 as me,a7 as pe,a8 as ve,a9 as fe,aa as N,ab as be,ac as he,ad as O,ae as ge,t as A,af as ye,c as h,o as d,w as m,q as r,ag as we,I as B,ah as ke,e as v,b as g,r as H,d as M,Q as Le,a1 as xe,T as Ce,h as F,z as _e,j as I,a as n,D as Re,v as c,p as f,s as U,C as Ee,x as _,y as Te,N as De}from"./main-CE88ee4Q.js";import{s as ze}from"./index-Drofbpnb.js";import{s as Se,a as Oe}from"./index-D0QGXrOb.js";import{s as Be}from"./index-DHTAa8Us.js";import{_ as Z}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{u as Ke,$ as Ie}from"./use-fetch-CNl_4VEC.js";import{_ as Ae}from"./SvgIcon.vue_vue_type_script_setup_true_lang-D1ll_v24.js";import{s as Pe}from"./index-Cf5x4JsD.js";import{u as Ve}from"./use-swrv-ttgJgnvy.js";import"./index-BPNPmUFq.js";import"./index-wutX35Rh.js";var $e=oe`
    .p-popover {
        margin-block-start: dt('popover.gutter');
        background: dt('popover.background');
        color: dt('popover.color');
        border: 1px solid dt('popover.border.color');
        border-radius: dt('popover.border.radius');
        box-shadow: dt('popover.shadow');
    }

    .p-popover-content {
        padding: dt('popover.content.padding');
    }

    .p-popover-flipped {
        margin-block-start: calc(dt('popover.gutter') * -1);
        margin-block-end: dt('popover.gutter');
    }

    .p-popover-enter-from {
        opacity: 0;
        transform: scaleY(0.8);
    }

    .p-popover-leave-to {
        opacity: 0;
    }

    .p-popover-enter-active {
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-popover-leave-active {
        transition: opacity 0.1s linear;
    }

    .p-popover:after,
    .p-popover:before {
        bottom: 100%;
        left: calc(dt('popover.arrow.offset') + dt('popover.arrow.left'));
        content: ' ';
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
    }

    .p-popover:after {
        border-width: calc(dt('popover.gutter') - 2px);
        margin-left: calc(-1 * (dt('popover.gutter') - 2px));
        border-style: solid;
        border-color: transparent;
        border-bottom-color: dt('popover.background');
    }

    .p-popover:before {
        border-width: dt('popover.gutter');
        margin-left: calc(-1 * dt('popover.gutter'));
        border-style: solid;
        border-color: transparent;
        border-bottom-color: dt('popover.border.color');
    }

    .p-popover-flipped:after,
    .p-popover-flipped:before {
        bottom: auto;
        top: 100%;
    }

    .p-popover.p-popover-flipped:after {
        border-bottom-color: transparent;
        border-top-color: dt('popover.background');
    }

    .p-popover.p-popover-flipped:before {
        border-bottom-color: transparent;
        border-top-color: dt('popover.border.color');
    }
`,Ne={root:"p-popover p-component",content:"p-popover-content"},He=ie.extend({name:"popover",style:$e,classes:Ne}),Fe={name:"BasePopover",extends:de,props:{dismissable:{type:Boolean,default:!0},appendTo:{type:[String,Object],default:"body"},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},breakpoints:{type:Object,default:null},closeOnEscape:{type:Boolean,default:!0}},style:He,provide:function(){return{$pcPopover:this,$parentInstance:this}}},q={name:"Popover",extends:Fe,inheritAttrs:!1,emits:["show","hide"],data:function(){return{visible:!1}},watch:{dismissable:{immediate:!0,handler:function(e){e?this.bindOutsideClickListener():this.unbindOutsideClickListener()}}},selfClick:!1,target:null,eventTarget:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,styleElement:null,overlayEventListener:null,documentKeydownListener:null,beforeUnmount:function(){this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.destroyStyle(),this.unbindResizeListener(),this.target=null,this.container&&this.autoZIndex&&O.clear(this.container),this.overlayEventListener&&(T.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.container=null},mounted:function(){this.breakpoints&&this.createStyle()},methods:{toggle:function(e,a){this.visible?this.hide():this.show(e,a)},show:function(e,a){this.visible=!0,this.eventTarget=e.currentTarget,this.target=a||e.currentTarget},hide:function(){this.visible=!1},onContentClick:function(){this.selfClick=!0},onEnter:function(e){var a=this;ge(e,{position:"absolute",top:"0"}),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoZIndex&&O.set("overlay",e,this.baseZIndex+this.$primevue.config.zIndex.overlay),this.overlayEventListener=function(p){a.container.contains(p.target)&&(a.selfClick=!0)},this.focus(),T.on("overlay-click",this.overlayEventListener),this.$emit("show"),this.closeOnEscape&&this.bindDocumentKeyDownListener()},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.unbindDocumentKeyDownListener(),T.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null,this.$emit("hide")},onAfterLeave:function(e){this.autoZIndex&&O.clear(e)},alignOverlay:function(){fe(this.container,this.target,!1);var e=N(this.container),a=N(this.target),p=0;e.left<a.left&&(p=a.left-e.left),this.container.style.setProperty(be("popover.arrow.left").name,"".concat(p,"px")),e.top<a.top&&(this.container.setAttribute("data-p-popover-flipped","true"),!this.isUnstyled&&he(this.container,"p-popover-flipped"))},onContentKeydown:function(e){e.code==="Escape"&&this.closeOnEscape&&(this.hide(),ve(this.target))},onButtonKeydown:function(e){switch(e.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":e.preventDefault()}},focus:function(){var e=this.container.querySelector("[autofocus]");e&&e.focus()},onKeyDown:function(e){e.code==="Escape"&&this.closeOnEscape&&(this.visible=!1)},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeyDown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var e=this;!this.outsideClickListener&&pe()&&(this.outsideClickListener=function(a){e.visible&&!e.selfClick&&!e.isTargetClicked(a)&&(e.visible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new me(this.target,function(){e.visible&&(e.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.visible&&!ce()&&(e.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked:function(e){return this.eventTarget&&(this.eventTarget===e.target||this.eventTarget.contains(e.target))},containerRef:function(e){this.container=e},createStyle:function(){if(!this.styleElement&&!this.isUnstyled){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",ue(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement);var a="";for(var p in this.breakpoints)a+=`
                        @media screen and (max-width: `.concat(p,`) {
                            .p-popover[`).concat(this.$attrSelector,`] {
                                width: `).concat(this.breakpoints[p],` !important;
                            }
                        }
                    `);this.styleElement.innerHTML=a}},destroyStyle:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},onOverlayClick:function(e){T.emit("overlay-click",{originalEvent:e,target:this.target})}},directives:{focustrap:le,ripple:ae},components:{Portal:re}},je=["aria-modal"];function Me(t,e,a,p,y,s){var L=A("Portal"),w=ye("focustrap");return d(),h(L,{appendTo:t.appendTo},{default:m(function(){return[r(we,B({name:"p-popover",onEnter:s.onEnter,onLeave:s.onLeave,onAfterLeave:s.onAfterLeave},t.ptm("transition")),{default:m(function(){return[y.visible?ke((d(),g("div",B({key:0,ref:s.containerRef,role:"dialog","aria-modal":y.visible,onClick:e[3]||(e[3]=function(){return s.onOverlayClick&&s.onOverlayClick.apply(s,arguments)}),class:t.cx("root")},t.ptmi("root")),[t.$slots.container?H(t.$slots,"container",{key:0,closeCallback:s.hide,keydownCallback:function(x){return s.onButtonKeydown(x)}}):(d(),g("div",B({key:1,class:t.cx("content"),onClick:e[0]||(e[0]=function(){return s.onContentClick&&s.onContentClick.apply(s,arguments)}),onMousedown:e[1]||(e[1]=function(){return s.onContentClick&&s.onContentClick.apply(s,arguments)}),onKeydown:e[2]||(e[2]=function(){return s.onContentKeydown&&s.onContentKeydown.apply(s,arguments)})},t.ptm("content")),[H(t.$slots,"default")],16))],16,je)),[[w]]):v("",!0)]}),_:3},16,["onEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])}q.render=Me;const Ue="/assets/investment-success-DHurTg2a.jpg",Ze={key:0,class:"w-full flex flex-col gap-3"},qe={class:"rounded-xl overflow-hidden h-60"},Ge=["src"],Ye={class:"grid gap-2"},Je={class:"font-semibold"},Qe={class:"mt-2 grid gap-1"},We={class:"flex items-center justify-between gap-1"},Xe={class:"flex items-center"},et={class:"text-sm"},tt={class:"mt-2 text-xs"},nt=M({__name:"investment-purchase-form",props:{investmentName:{},investmentTier:{},walletBalance:{}},setup(t){const e=Le(),a=xe(),p=Ce("op"),y=F(!1),s=_e({amount:0,autocompounded:!1}),L=I(()=>{if(!t.investmentTier)return"0";const{duration:l,expectedReturnRate:o}=t.investmentTier,E=o/100/l;return s.autocompounded?`${(((1+E)**l-1)*100).toFixed(1)}%`:`${o}%`}),w=F({}),{isFetching:u,error:x,data:i,execute:R}=Ke("/api/users/me/investments",{immediate:!1}).post(w).json();async function D(){var b;const l=Number(L.value.split("%")[0]),o=Number((s.amount*(1+(s.autocompounded?l:t.investmentTier.expectedReturnRate)/100)).toFixed(2));w.value={userId:e.user.id,autocompounded:s.autocompounded,investmentStatus:"OPEN",initialDeposit:s.amount,expectedReturnRate:t.investmentTier.expectedReturnRate,autocompoundedReturnRate:s.autocompounded?l:void 0,expectedTotalReturns:o,currentTotalReturns:0,currentCompoundedAmount:s.autocompounded?s.amount:void 0,investmentName:t.investmentName,investmentTier:t.investmentTier.name,minimumDeposit:t.investmentTier.minimumDeposit,duration:t.investmentTier.duration,terminationFee:t.investmentTier.terminationFee,daysCompleted:0},await R(),(b=i.value)!=null&&b.success&&(w.value=i.value.investment,y.value=!0)}const z=I(()=>u.value||!s.amount||!t.walletBalance||!t.investmentTier||t.walletBalance<t.investmentTier.minimumDeposit),C=async()=>{a.require({message:"Proceed with this investment?",header:"Confirmation",icon:"pi pi-exclamation-circle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Proceed"},accept:()=>{D()}})};return(l,o)=>{const b=U,E=Re,S=Z,P=Oe,G=Be,V=Se,Y=te,J=ze,Q=A("RouterLink"),W=q,X=se,ee=j;return d(),g("div",null,[r(E,{visible:y.value,"onUpdate:visible":o[1]||(o[1]=k=>y.value=k),modal:"",header:"Done!",closable:!1,class:"dark:bg-slate-900",style:{width:"22rem"}},{default:m(()=>[c(i)?(d(),g("div",Ze,[n("div",qe,[n("img",{src:c(Ue),class:"w-full h-full object-contain"},null,8,Ge)]),o[5]||(o[5]=n("p",{class:"text-center"},[f(" Congratulations! "),n("br"),f(" You can now expect daily returns on your new investment. ")],-1)),r(b,{onClick:o[0]||(o[0]=k=>l.$router.push({name:"user-investment-item",params:{investment_id:w.value.id}})),fluid:"",label:"Continue"})])):v("",!0)]),_:1},8,["visible"]),r(S,{error:c(x)},null,8,["error"]),n("form",{onSubmit:Ee(C,["prevent"]),class:"grid gap-2"},[n("div",Ye,[o[9]||(o[9]=n("label",{class:"text-sm text-mute font-semibold"},"Enter amount",-1)),r(V,{class:"w-full *:dark:bg-slate-800"},{default:m(()=>[r(P,null,{default:m(()=>o[6]||(o[6]=[f("$")])),_:1,__:[6]}),r(G,{modelValue:s.amount,"onUpdate:modelValue":o[2]||(o[2]=k=>s.amount=k),min:l.investmentTier.minimumDeposit,max:l.walletBalance,minFractionDigits:0,maxFractionDigits:2,placeholder:"00.00",class:"w-full *:dark:bg-slate-800"},null,8,["modelValue","min","max"])]),_:1}),n("small",null,[o[7]||(o[7]=f("Minimum deposit ")),n("span",Je,_(c(K).format(l.investmentTier.minimumDeposit)),1)]),l.walletBalance<l.investmentTier.minimumDeposit?(d(),h(Y,{key:0,severity:"error",size:"small"},{default:m(()=>o[8]||(o[8]=[f(" You do not have enough funds to complete this investment. ")])),_:1,__:[8]})):v("",!0)]),n("div",Qe,[o[11]||(o[11]=n("label",{class:"text-mute text-sm font-semibold"},"Expected Return Rate",-1)),l.investmentTier?(d(),h(V,{key:0,class:"w-full *:dark:bg-slate-800"},{default:m(()=>[r(P,null,{default:m(()=>o[10]||(o[10]=[n("span",{class:"pi pi-percentage"},null,-1)])),_:1,__:[10]}),r(J,{value:L.value,readOnly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})):v("",!0)]),n("div",We,[n("div",Xe,[o[14]||(o[14]=n("label",{class:"text-mute text-sm font-semibold"},"Autocompound Investment",-1)),r(b,{onClick:o[3]||(o[3]=k=>{var $;($=p.value)==null||$.toggle(k)}),size:"small",text:"",icon:"pi pi-question-circle",rounded:""}),r(W,{ref_key:"op",ref:p,class:"max-w-60"},{default:m(()=>[n("div",et,[o[13]||(o[13]=n("p",{class:"text-mute font-medium"},"Autocompounded Investments",-1)),n("div",tt,[o[12]||(o[12]=n("p",null," Autocompounded investments promise higher returns but profits are not withdrawable until the end of the investment term or when the investment is terminated. ",-1)),r(Q,{to:{name:"user-faq-item",params:{faq_item_slug:"auto-compounding"}},target:"_blank"},{default:m(()=>[r(b,{size:"small",class:"mt-2 text-sm",icon:"pi pi-external-link","icon-pos":"right",label:"See More",fluid:""})]),_:1})])])]),_:1},512)]),r(X,{modelValue:s.autocompounded,"onUpdate:modelValue":o[4]||(o[4]=k=>s.autocompounded=k)},null,8,["modelValue"])]),r(ee),r(b,{loading:c(u),type:"submit",fluid:"",label:"Proceed",icon:"pi pi-check-circle",disabled:z.value},null,8,["loading","disabled"])],32)])}}}),st={class:"h-full"},ot={key:1,class:"w-full flex-center"},it={key:2,class:"grid gap-2 md:grid-cols-5 lg:grid-cols-3"},rt={class:"md:col-span-2 lg:col-span-1"},at={class:"v-card grid"},lt={key:0,class:"mt-2 flex flex-col gap-2 items-center justify-center"},dt={class:"uppercase text-lg text-center font-semibold"},ut={key:1,class:"w-full"},ct={class:"grid grid-cols-3 text-sm"},mt={class:"text-right font-semibold"},pt={class:"grid grid-cols-3 text-sm"},vt={class:"text-right font-semibold"},ft={class:"grid grid-cols-3 text-sm"},bt={class:"text-right font-semibold"},ht={class:"text-xs text-mute"},gt={class:"md:col-span-3 lg:col-span-2"},yt={class:"v-card"},wt={class:"flex gap-3"},kt={class:"flex-grow flex items-center gap-x-2 justify-between flex-wrap"},Lt={class:"text-xl md:text-2xl font-semibold text-green-600"},xt={key:0},Pt=M({__name:"investment-purchase",setup(t){const e=Te(),a=e.params.investment_plan_slug.toString(),p=e.params.investment_plan_tier_name.toString(),{isLoading:y,data:s,error:L,mutate:w}=Ve(`/api/users/me/investments/initialize/${a}`,Ie),u=I(()=>{var x,i;return(i=(x=s.value)==null?void 0:x.plan.tiers)==null?void 0:i.find(R=>R.name.toLowerCase()===p.toLowerCase())});return(x,i)=>{const R=De,D=Z,z=Pe,C=Ae,l=j,o=A("RouterLink"),b=U,E=nt,S=ne;return d(),h(S,{name:"user"},{default:m(()=>[n("div",st,[c(y)?(d(),h(R,{key:0})):c(L)?(d(),g("div",ot,[r(D,{error:c(L),"should-retry":"",onRetry:c(w)},null,8,["error","onRetry"])])):c(s)?(d(),g("div",it,[n("div",rt,[n("div",at,[r(z,{severity:"secondary",value:c(s).plan.name,class:"dark:bg-slate-800"},null,8,["value"]),u.value?(d(),g("div",lt,[n("p",dt,_(u.value.name),1),u.value.name.toLowerCase()==="basic"?(d(),h(C,{key:0,name:"plant",size:"100"})):v("",!0),u.value.name.toLowerCase()==="bronze"?(d(),h(C,{key:1,name:"bronze-medal",size:"100"})):v("",!0),u.value.name.toLowerCase()==="silver"?(d(),h(C,{key:2,name:"silver-medal",size:"100"})):v("",!0),u.value.name.toLowerCase()==="gold"?(d(),h(C,{key:3,name:"gold-medal",size:"100"})):v("",!0),u.value.name.toLowerCase()==="platinum"?(d(),h(C,{key:4,name:"platinum",size:"100"})):v("",!0)])):v("",!0),r(l),u.value?(d(),g("div",ut,[n("div",ct,[i[0]||(i[0]=n("p",{class:"col-span-2 flex items-center gap-1 text-mute"},[n("span",{class:"pi pi-money-bill"}),f(" Minimum Amount ")],-1)),n("p",mt,_(c(K).format(u.value.minimumDeposit)),1)]),r(l),n("div",pt,[i[1]||(i[1]=n("p",{class:"col-span-2 flex items-center gap-1 text-mute"},[n("span",{class:"pi pi-calendar"}),f(" Term ")],-1)),n("p",vt,_(u.value.duration)+" days",1)]),r(l),n("div",ft,[i[2]||(i[2]=n("p",{class:"col-span-2 flex items-center gap-1 text-mute"},[n("span",{class:"pi pi-replay"}),f(" Expected Return ")],-1)),n("p",bt,_(u.value.expectedReturnRate)+"%",1)]),r(l),n("p",ht,[i[5]||(i[5]=n("span",{class:"pi pi-info-circle float-left mr-1"},null,-1)),i[6]||(i[6]=f(" By proceeding with this investment, you know and acknowledge the ")),r(o,{to:{name:"user-risk-acknowledgment"},class:"text-primary-500 font-semibold hover:underline"},{default:m(()=>i[3]||(i[3]=[f("risks of investment")])),_:1,__:[3]}),i[7]||(i[7]=f(" and agree to our ")),r(o,{target:"_blank",to:{name:"terms-of-use"},class:"text-primary-500 font-semibold hover:underline"},{default:m(()=>i[4]||(i[4]=[f(" terms of use "),n("span",{class:"pi pi-external-link",style:{"font-size":"0.6rem","font-weight":"700"}},null,-1)])),_:1,__:[4]}),i[8]||(i[8]=f(". "))])])):v("",!0)]),r(o,{to:{name:"user-investment-plans"}},{default:m(()=>[r(b,{severity:"secondary",fluid:"",label:"Back to investment plans",class:"mt-4 border-transparent bg-slate-300 dark:bg-slate-700"})]),_:1})]),n("div",gt,[n("div",yt,[n("div",wt,[i[10]||(i[10]=n("span",{class:"pi pi-wallet bg-blue-400 dark:bg-blue-500/30 rounded-full p-2 text-white"},null,-1)),n("div",kt,[i[9]||(i[9]=n("p",{class:"text-mute text-sm md:text-base"},"Available Balance",-1)),n("p",Lt,_(c(K).format(c(s).walletBalance)),1)])]),r(l),u.value?(d(),g("div",xt,[r(E,{"investment-name":c(s).plan.name,"investment-tier":u.value,"wallet-balance":c(s).walletBalance},null,8,["investment-name","investment-tier","wallet-balance"])])):v("",!0)])])])):v("",!0)])]),_:1})}}});export{Pt as default};
