import{_ as M,d as Y,s as H,a as Q}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as J}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{s as K}from"./index-BXAGMbEd.js";import{s as O,a as X}from"./index-D0QGXrOb.js";import{s as Z}from"./index-Drofbpnb.js";import{_ as ee}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{d as te,Y as se,Q as le,h as _,j as $,k as ae,V as re,m as oe,c as y,w as a,a as t,q as s,b as ne,e as ue,s as ie,D as de,v as l,N as ce,x as c,p as m,t as me,o as v}from"./main-CE88ee4Q.js";import{_ as we}from"./VNavbar.vue_vue_type_script_setup_true_lang-GcHfqelS.js";import{u as pe,$ as fe}from"./use-fetch-CNl_4VEC.js";import{u as _e}from"./use-swrv-ttgJgnvy.js";import"./bundle-mjs-CLJs87Zn.js";import"./iconify-0_DS-cBL.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";const ve={class:"h-full"},ge={class:"mt-4"},be={key:2,class:"flex items-center justify-center py-4"},ye={class:"text-center"},he={class:"text-2xl font-semibold"},xe={class:"flex flex-col items-center justify-center gap-1"},ke=["src"],Re={class:"text-center font-semibold"},qe={class:"grid gap-3 w-full"},$e={class:"grid gap-1"},Ce={class:"grid gap-1"},Ae={class:"grid gap-1"},Se={class:"grid gap-1"},De={class:"w-5 rounded-full overlow-hidden"},Ve=["src"],Ne={class:"grid gap-1"},Ie={class:"text-mute font-semibold text-sm"},Ue={class:"grid gap-1"},Le={class:"text-mute font-semibold text-sm"},We={class:"grid gap-1"},Te={class:"grid gap-1"},Be={class:"grid gap-1"},je={class:"font-normal text-center"},Ee={class:"font-semibold text-lg"},Fe={class:"mt-3 text-sm"},Pe={class:"mt-3 w-full grid gap-2"},at=te({__name:"withdrawal-validate",setup(ze){const C=re(),A=se(),o=le(),g=_(!1),h=_({}),b=_(""),x=_(`/api/users/me/currencies/${o.withdrawalRequest.currency.id}/rate`),{isLoading:S,error:D,data:r,mutate:V}=_e(()=>x.value,fe),N=$(()=>{var n,e;return(((n=o.withdrawalRequest)==null?void 0:n.amount)||0)-(((e=r.value)==null?void 0:e.currency.withdrawalCharge)||0)}),k=$(()=>{var p,w;const n=((p=o.withdrawalRequest)==null?void 0:p.amount)||0,e=((w=r.value)==null?void 0:w.currency.rate)||0;return e?n/e:0}),{isFetching:I,error:R,data:U,execute:L}=pe(()=>"/api/users/me/transactions/withdrawal",{immediate:!1}).post(h).json(),W=async()=>{var n;if(!((n=r.value)!=null&&n.currency)||!o.withdrawalRequest){A.add({severity:"Error",summary:"Error",detail:"Failed to complete withdrawal request. Please, try again later."});return}h.value={userId:o.user.id,transactionType:"WITHDRAWAL",transactionStatus:"PENDING",amountInUSD:o.withdrawalRequest.amount,charge:r.value.currency.withdrawalCharge,actualAmountInUSD:o.withdrawalRequest.amount-r.value.currency.withdrawalCharge,rate:r.value.currency.rate,currency:r.value.currency.abbr,amountInCurrency:o.withdrawalRequest.amount/r.value.currency.rate,isWireTransfer:!1,withdrawalWalletAddress:o.withdrawalRequest.walletAddress,withdrawalWalletAddressNetwork:o.withdrawalRequest.walletAddressNetwork,description:b.value},await L(),!(R.value||!U.value.success)&&(x.value=null,o.withdrawalRequest=null,g.value=!0)};return ae(()=>{if(!o.withdrawalRequest){C.push({name:"user-withdrawal-initialize"});return}}),oe(()=>{o.withdrawalRequest=null}),(n,e)=>{const p=we,w=ie,T=de,B=ce,q=ee,j=H,u=X,i=Z,d=O,E=K,F=Q,P=me("RouterLink"),z=J,G=M;return v(),y(G,{name:"user"},{default:a(()=>[t("div",ve,[s(p),s(T,{visible:g.value,"onUpdate:visible":e[1]||(e[1]=f=>g.value=f),modal:"",header:"Deposit Request",class:"max-w-[90dvw] md:w-96 dark:bg-slate-900",closable:!1},{default:a(()=>[e[3]||(e[3]=t("div",{class:"flex flex-col items-center justify-center text-center"},[t("span",{class:"pi pi-check-circle text-emerald-500",style:{"font-size":"40px"}}),t("p",{class:"mt-4"},"Your withdrawal request has been received."),t("p",null," The amount will be deducted from your account balance and your wallet address will be credited within 24 hours. ")],-1)),t("div",ge,[s(w,{onClick:e[0]||(e[0]=f=>n.$router.push({name:"user-transactions"})),label:"Continue",fluid:""})])]),_:1,__:[3]},8,["visible"]),l(S)?(v(),y(B,{key:0})):l(D)?(v(),y(q,{key:1,"should-retry":"",onRetry:l(V)},null,8,["onRetry"])):l(o).withdrawalRequest&&l(r)?(v(),ne("div",be,[s(z,{class:"w-full max-w-[28rem] md:!p-6"},{default:a(()=>[t("div",ye,[t("p",he,c(l(Y).format(l(o).withdrawalRequest.user.walletBalance)),1),e[4]||(e[4]=t("p",null,"Account Balance",-1))]),s(j),t("div",xe,[t("img",{src:l(r).currency.image||"",width:"40"},null,8,ke),t("p",Re,c(l(r).currency.name)+" Withdrawal",1),t("div",qe,[t("div",$e,[e[6]||(e[6]=t("label",{class:"text-mute font-semibold text-sm"},"Amount (USD)",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[5]||(e[5]=[m("$")])),_:1,__:[5]}),s(i,{value:l(o).withdrawalRequest.amount.toLocaleString(),readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Ce,[e[8]||(e[8]=t("label",{class:"text-mute font-semibold text-sm"},"Charge (USD)",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[7]||(e[7]=[m("$")])),_:1,__:[7]}),s(i,{value:l(r).currency.withdrawalCharge.toLocaleString(),readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Ae,[e[10]||(e[10]=t("label",{class:"text-mute font-semibold text-sm"},"Actual Amount (USD)",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[9]||(e[9]=[m("$")])),_:1,__:[9]}),s(i,{value:N.value.toLocaleString(),readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Se,[e[11]||(e[11]=t("label",{class:"text-mute font-semibold text-sm"},"Currency",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>[t("div",De,[t("img",{src:l(r).currency.image||"",class:"w-full h-full object-cover"},null,8,Ve)])]),_:1}),s(i,{value:l(r).currency.name,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Ne,[t("label",Ie," Rate (1 "+c(l(r).currency.abbr)+" to USD) ",1),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[12]||(e[12]=[t("span",{class:"pi pi-arrow-right-arrow-left"},null,-1)])),_:1,__:[12]}),s(i,{value:l(r).currency.rate,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Ue,[t("label",Le," Amount ("+c(l(r).currency.abbr)+") ",1),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>[m(c(l(r).currency.symbol),1)]),_:1}),s(i,{value:k.value,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",We,[e[14]||(e[14]=t("label",{class:"text-mute font-semibold text-sm"},"Your Wallet Address",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[13]||(e[13]=[t("span",{class:"pi pi-wallet"},null,-1)])),_:1,__:[13]}),s(i,{value:l(o).withdrawalRequest.walletAddress,readonly:"",class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Te,[e[16]||(e[16]=t("label",{class:"text-mute font-semibold text-sm"},"Network",-1)),s(d,{class:"w-full *:dark:bg-slate-800"},{default:a(()=>[s(u,null,{default:a(()=>e[15]||(e[15]=[t("span",{class:"pi pi-share-alt"},null,-1)])),_:1,__:[15]}),s(i,{value:l(o).withdrawalRequest.walletAddressNetwork,class:"w-full *:dark:bg-slate-800"},null,8,["value"])]),_:1})]),t("div",Be,[e[17]||(e[17]=t("label",{class:"text-mute font-semibold text-sm"}," Provide an optional note or description about your request ",-1)),s(E,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=f=>b.value=f),rows:"3",class:"resize-none"},null,8,["modelValue"])])]),s(F,{class:"mt-2"},{default:a(()=>[t("p",je,[t("span",Ee,c(l(r).currency.abbr)+" "+c(k.value),1),e[18]||(e[18]=m(" will be sent to your provided wallet address within 24 hours. "))])]),_:1}),t("div",Fe,[t("p",null,[e[20]||(e[20]=m(" Need help? ")),s(P,{to:{name:"user-contact"},class:"text-primary-500 hover:underline font-semibold"},{default:a(()=>e[19]||(e[19]=[m(" Contact us ")])),_:1,__:[19]})])]),t("div",Pe,[s(q,{error:l(R)},null,8,["error"]),s(w,{onClick:W,loading:l(I),label:"Complete withdrawal request",fluid:""},null,8,["loading"])])])]),_:1})])):ue("",!0)])]),_:1})}}});export{at as default};
