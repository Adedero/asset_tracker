import{_ as F,t as N,d as M}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{_ as O}from"./VPaginator.vue_vue_type_script_setup_true_lang-d1R-1bBh.js";import{s as G,a as W}from"./index-DXvl-esB.js";import{s as B}from"./index-Cf5x4JsD.js";import{d as Y,h as p,j as w,X as j,i as I,c as h,w as i,a as s,q as a,v as l,s as K,D as q,n as L,x as _,U as H,e as V,o as C}from"./main-CE88ee4Q.js";import{_ as Q}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{s as X}from"./index-BGiSEDGv.js";import{$ as J}from"./use-fetch-CNl_4VEC.js";import{u as Z}from"./use-swrv-ttgJgnvy.js";import"./index-DHTAa8Us.js";import"./index-Drofbpnb.js";import"./index-wutX35Rh.js";import"./index-BPNPmUFq.js";import"./index-B88Wmsvc.js";const ee={class:"v-card !p-3"},te={class:"flex items-center justify-between"},se={class:"hidden md:flex items-end gap-2 justify-end"},ae={class:"grid gap-1"},oe={class:"grid gap-1"},le={class:"flex flex-col gap-2"},ne={class:"grid gap-1"},ie={class:"grid gap-1"},re={class:"grid grid-cols-2 gap-2 mt-2"},de={class:"mt-2 h-[calc(100dvh-10rem)] md:h-[calc(100dvh-11rem)]"},ue={class:"w-full"},me={class:"md:max-h-[calc(100dvh-16rem)] overflow-auto w-full rounded-lg"},pe={class:"text-center font-medium"},ce={class:"flex items-center gap-1"},be=Y({__name:"transactions",setup(ve){const m=p(0),c=j,v=p(!1),u=p({type:["ALL","DEPOSIT","WITHDRAWAL","INVESTMENT","PROFIT"],status:["ALL","SUCCESSFUL","PENDING","FAILED"]}),r=p(u.value.type[0]),d=p(u.value.status[0]),b=w(()=>{const o=new URLSearchParams;return o.set("take",c.toString()),o.set("skip",(m.value*c).toString()),o.set("sort","createdAt,desc"),r.value!=="ALL"&&o.append("where",`transactionType,${r.value}`),d.value!=="ALL"&&o.set("where",`transactionStatus,${d.value}`),o.toString()});I(d,()=>m.value=0),I(r,()=>m.value=0);const{isLoading:S,data:f,error:$,mutate:T}=Z(()=>`/api/users/me/transactions?${b.value}`,J),U=w(()=>{var o;return((o=f.value)==null?void 0:o.transactions.length)||0}),A=w(()=>{var o;return!!((o=f.value)!=null&&o.transactions)&&f.value.transactions.length<c});return(o,t)=>{const g=X,y=K,E=Q,P=q,n=G,x=B,R=W,k=O,z=F;return C(),h(z,{name:"user"},{default:i(()=>{var D;return[s("div",null,[s("div",ee,[s("div",te,[t[14]||(t[14]=s("h1",{class:"text-lg font-semibold text-primary-500 dark:text-primary-400"},"Transactions",-1)),s("div",se,[s("div",ae,[t[12]||(t[12]=s("p",{class:"text-sm font-medium text-mute text-right"},"Type",-1)),a(g,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),size:"small",options:u.value.type},null,8,["modelValue","options"])]),s("div",oe,[t[13]||(t[13]=s("p",{class:"text-sm font-medium text-mute text-right"},"Status",-1)),a(g,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),size:"small",options:u.value.status},null,8,["modelValue","options"])]),a(y,{onClick:t[2]||(t[2]=e=>l(T)()),loading:l(S),label:"Submit",size:"small"},null,8,["loading"])]),a(y,{onClick:t[3]||(t[3]=e=>v.value=!0),class:"md:hidden",label:"Filters",icon:"pi pi-filter","icon-pos":"right",size:"small"})]),a(E,{error:l($),"should-retry":"",onRetry:t[4]||(t[4]=e=>l(T)()),class:"mt-2"},null,8,["error"]),a(P,{visible:v.value,"onUpdate:visible":t[9]||(t[9]=e=>v.value=e),modal:"",header:"Filters",class:"w-80"},{default:i(()=>[s("div",le,[s("div",ne,[t[15]||(t[15]=s("p",{class:"text-sm font-medium text-mute"},"Type",-1)),a(g,{modelValue:r.value,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value=e),size:"small",options:u.value.type},null,8,["modelValue","options"])]),s("div",ie,[t[16]||(t[16]=s("p",{class:"text-sm font-medium text-mute"},"Status",-1)),a(g,{modelValue:d.value,"onUpdate:modelValue":t[6]||(t[6]=e=>d.value=e),size:"small",options:u.value.status},null,8,["modelValue","options"])]),s("div",re,[a(y,{onClick:t[7]||(t[7]=e=>v.value=!1),size:"small",severity:"secondary",label:"Cancel"}),a(y,{onClick:t[8]||(t[8]=e=>l(T)()),loading:l(S),size:"small",label:"Submit"},null,8,["loading"])])])]),_:1},8,["visible"])]),s("div",de,[s("div",ue,[s("div",me,[a(R,{loading:l(S),value:(D=l(f))==null?void 0:D.transactions,selectionMode:"single",dataKey:"id",metaKeySelection:!1,stripedRows:"",class:"text-sm",onRowSelect:t[10]||(t[10]=e=>o.$router.push({name:"user-transaction-receipt",params:{transaction_id:e.data.id}})),tableStyle:"min-width: 50rem; white-space: nowrap"},{default:i(()=>[a(n,{field:"transactionType",header:"Type"},{body:i(({data:e})=>[s("div",{class:L(["flex-col-center",e.transactionType==="DEPOSIT"||e.transactionType==="PROFIT"?"text-green-500":"text-red-500"])},[s("span",{class:L(e.transactionType==="DEPOSIT"||e.transactionType==="PROFIT"?"pi pi-arrow-circle-down":"pi pi-arrow-circle-up")},null,2),s("small",pe,_(l(N)(e.transactionType)),1)],2)]),_:1}),a(n,{field:"createdAt",header:"Date"},{body:i(({data:e})=>[s("p",null,_(l(H)(e.createdAt,"dddd YYYY-MMM-DD, hh:mm:ss A",{locales:"en-US"})),1)]),_:1}),a(n,{field:"id",header:"Transaction ID"}),a(n,{field:"amountInUSD",header:"Amount (USD)"},{body:i(({data:e})=>[s("p",{class:L(["font-medium",e.transactionType==="DEPOSIT"||e.transactionType==="PROFIT"?"text-green-500":"text-red-500"])},_(l(M).format(e.amountInUSD)),3)]),_:1}),a(n,{field:"currency",header:"Currency"},{body:i(({data:e})=>[s("div",ce,[s("p",null,_(e.currency),1),e.isWireTransfer?(C(),h(x,{key:0,size:"small",class:"text-xs whitespace-nowrap",value:"Wire Transfer"})):V("",!0),e.isGiftCard?(C(),h(x,{key:1,size:"small",class:"text-xs whitespace-nowrap",value:"Gift Card"})):V("",!0)])]),_:1}),a(n,{field:"rate",header:"Rate"}),a(n,{field:"amountInCurrency",header:"Amount in Currency"}),a(n,{field:"status",header:"Status"},{body:i(({data:e})=>[a(x,{severity:e.transactionStatus==="SUCCESSFUL"?"success":e.transactionStatus==="PENDING"?"warn":"danger",value:e.transactionStatus.toLowerCase(),class:"text-xs"},null,8,["severity","value"])]),_:1})]),_:1},8,["loading","value"])]),a(k,{allLoaded:A.value,length:U.value,rows:l(c),page:m.value,"onUpdate:page":t[11]||(t[11]=e=>m.value=e)},null,8,["allLoaded","length","rows","page"])])])])]}),_:1})}}});export{be as default};
