import{_ as F,t as M}from"./vue-layout.vue_vue_type_script_setup_true_lang-Dd9kIAe8.js";import{d as P,a1 as R,Y as U,V as K,h as z,c as u,w as m,a as t,q as p,b as n,e as c,v as e,N as T,x as l,s as j,U as D,o}from"./main-CE88ee4Q.js";import{_ as B}from"./VErrorMessage.vue_vue_type_script_setup_true_lang-U_TlgEzX.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-va0MW3Xd.js";import{u as q,$ as G}from"./use-fetch-CNl_4VEC.js";import{u as L}from"./use-swrv-ttgJgnvy.js";import{I as W}from"./iconify-0_DS-cBL.js";import"./bundle-mjs-CLJs87Zn.js";const J={class:"mt-2"},O={key:2,class:"md:h-[calc(100dvh-8.5rem)] grid md:grid-cols-3 gap-2"},Q={class:"md:col-span-2 md:h-full md:overflow-y-auto"},X={class:"flex items-center gap-5 justify-between"},Z={class:"mt-4 grid gap-2"},tt={class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},et={class:"text-right font-semibold"},st={key:0,class:"contents"},at={key:0,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},ot={class:"text-right font-semibold"},ct={key:1,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},it={class:"flex justify-end"},nt=["href","download"],rt={key:2,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},dt={class:"text-right font-semibold"},lt={key:3,class:"v-card !p-2 border dark:border-white/30 dark:bg-slate-800"},ut={class:"text-right font-semibold"},mt={class:"md:h-full md:overflow-y-auto"},pt={class:"flex flex-col items-center justify-center gap-2 text-center"},ft={class:"w-32 aspect-square rounded-full overflow-hidden bg-slate-200 dark:bg-slate-800"},yt=["src"],_t={class:"font-semibold md:text-lg"},kt={class:"text-sm text-mute"},It=P({__name:"kyc-review",setup(vt){var h;const y=K(),w=R(),_=U(),k=(h=y.currentRoute.value.params.account_id)==null?void 0:h.toString(),{isLoading:S,error:v,data:s,mutate:x}=L(()=>`/api/admins/me/accounts/${k}`,G),r=z({}),{isFetching:V,error:b,data:g,execute:I}=q(`/api/admins/me/accounts/${k}`).put(r).json();async function E(){var a,d;if(!((a=s.value)!=null&&a.account)||s.value.account.kycStatus==="UNVERIFIED")return;const i=s.value.account.kycStatus==="PENDING";if(r.value={kycIdType:i?r.value.kycIdType:null,kycDocument:i?r.value.kycDocument:null,kycDocumentExt:i?r.value.kycDocumentExt:null,kycStatus:i?"VERIFIED":"UNVERIFIED",kycSubmittedAt:i?r.value.kycSubmittedAt:null,kycVerifiedAt:i?new Date:null},await I(),b.value||!((d=g.value)!=null&&d.account)){_.add({severity:"error",summary:"Failed",detail:b.value.message});return}_.add({severity:"success",summary:"Done",detail:"KYC Status updated",life:3e3}),await x(()=>Promise.resolve({success:!0,message:"KYC Status updated",account:{...s.value.account,...g.value.account}}))}const C=()=>{w.require({header:"Update KYC Status",message:"Are you sure you want to proceed?",rejectProps:{label:"Cancel",severity:"secondary",icon:"pi pi-times"},acceptProps:{label:"Proceed",icon:"pi pi-check"},accept:()=>{E()}})};return(i,a)=>{const d=H,Y=T,N=B,f=j,$=F;return o(),u($,{name:"admin"},{default:m(()=>[t("div",null,[p(d,{class:"py-2 px-4"},{default:m(()=>a[2]||(a[2]=[t("div",{class:"text-lg text-primary-500 font-semibold"},"KYC Verification Status",-1)])),_:1,__:[2]}),t("div",J,[e(S)?(o(),u(Y,{key:0})):e(v)?(o(),u(N,{key:1,error:e(v),"should-retry":"",onRetry:a[0]||(a[0]=A=>e(x)())},null,8,["error"])):e(s)?(o(),n("div",O,[t("div",Q,[p(d,{header:"KYC Details"},{header:m(()=>[t("div",X,[a[3]||(a[3]=t("p",{class:"font-semibold text-mute"},"KYC Details",-1)),e(s).account.kycStatus!=="UNVERIFIED"?(o(),u(f,{key:0,label:e(s).account.kycStatus==="PENDING"?"Verify":"Discard",onClick:C,loading:e(V),icon:e(s).account.kycStatus==="PENDING"?"pi pi-check-circle":"pi pi-times-circle"},null,8,["label","loading","icon"])):c("",!0)])]),default:m(()=>[t("div",Z,[t("div",tt,[a[4]||(a[4]=t("div",{class:"flex items-center"},[t("span",{class:"pi pi-check-circle text-mute p-1 rounded-full",style:{"font-size":"12px"}}),t("p",{class:"text-mute text-sm font-semibold"},"KYC Status")],-1)),t("p",et,l(e(M)(e(s).account.kycStatus)),1)]),e(s).account.kycStatus!=="UNVERIFIED"?(o(),n("div",st,[e(s).account.kycIdType?(o(),n("div",at,[a[5]||(a[5]=t("div",{class:"flex items-center"},[t("span",{class:"pi pi-id-card text-mute p-1 rounded-full",style:{"font-size":"12px"}}),t("p",{class:"text-mute text-sm font-semibold"},"ID Type")],-1)),t("p",ot,l(e(s).account.kycIdType),1)])):c("",!0),e(s).account.kycDocument?(o(),n("div",ct,[a[6]||(a[6]=t("div",{class:"flex items-center"},[t("span",{class:"pi pi-file text-mute p-1 rounded-full",style:{"font-size":"12px"}}),t("p",{class:"text-mute text-sm font-semibold"},"Submitted Document")],-1)),t("div",it,[t("a",{href:e(s).account.kycDocument,download:`${e(s).account.id}.${e(s).account.kycDocumentExt}`},[p(f,{label:"Download",icon:"pi pi-download",size:"small",outlined:""})],8,nt)])])):c("",!0),e(s).account.kycSubmittedAt?(o(),n("div",rt,[a[7]||(a[7]=t("div",{class:"flex items-center"},[t("span",{class:"pi pi-calendar-clock text-mute p-1 rounded-full",style:{"font-size":"12px"}}),t("p",{class:"text-mute text-sm font-semibold"},"Submission Date")],-1)),t("p",dt,l(e(D)(new Date(e(s).account.kycSubmittedAt),"ddd, MMMM DD, YYYY HH:mm aa")),1)])):c("",!0),e(s).account.kycVerifiedAt?(o(),n("div",lt,[a[8]||(a[8]=t("div",{class:"flex items-center"},[t("span",{class:"pi pi-calendar-clock text-mute p-1 rounded-full",style:{"font-size":"12px"}}),t("p",{class:"text-mute text-sm font-semibold"},"Verified Date")],-1)),t("p",ut,l(e(D)(new Date(e(s).account.kycVerifiedAt),"ddd, MMMM DD, YYYY HH:mm aa")),1)])):c("",!0)])):c("",!0)])]),_:1})]),t("div",mt,[e(s).account.user?(o(),u(d,{key:0,header:"User"},{default:m(()=>[t("div",pt,[t("div",ft,[e(s).account.user.image?(o(),n("img",{key:0,src:e(s).account.user.image,class:"w-full h-full object-cover"},null,8,yt)):c("",!0),p(e(W),{icon:"ic:baseline-account-circle",style:{"font-size":"8rem"},class:"text-primary-500"})]),t("div",null,[t("p",_t,l(e(s).account.user.name),1),t("p",kt,l(e(s).account.user.email),1)]),p(f,{onClick:a[1]||(a[1]=A=>e(y).push({name:"admin-user-item",params:{user_id:e(s).account.user.id}})),label:"Profile",icon:"pi pi-user",outlined:""})])]),_:1})):c("",!0)])])):c("",!0)])])]),_:1})}}});export{It as default};
